;#Region ;**** Directives created by AutoIt3Wrapper_GUI ****
;#AutoIt3Wrapper_Compile_Both=y
;#EndRegion ;**** Directives created by AutoIt3Wrapper_GUI ****
;#include<Security.au3>
;#include 'ExtMsgBox.au3'
;#include 'CurrentUser.au3'


Func CheckCurrentAccountDocumentAARAntiExploit()

   Local $HKU_AdobeAcrobatReader = 'HKU\' & _GetCurrentUserSID() & '\Software\Adobe\Acrobat Reader'
   Local $NumberOfSettings = 19
   Local $n = 0
   Local $m = 0

  ;ADOBE READER
  ;Block JavaScript in Adobe Reader DC and Adobe Reader XI
  ;Block scripts
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\JSPrefs', 'bEnableJS', Number('0'))
  ;Script in one sandbox cannot access a script object in another sandbox
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\JSPrefs', 'bEnableGlobalSecurity', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\JSPrefs', 'bEnableJS', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\JSPrefs', 'bEnableGlobalSecurity', Number('1'))

  ;Adobe Acrobat 10+ Enables Protected Mode and thereby sandboxes Reader processes
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\Privileged', 'bProtectedMode', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\Privileged', 'bProtectedMode', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\Privileged', 'bEnableProtectedModeAppContainer', Number('1'))
  ;Turns on Protected View
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'iProtectedView', Number('2'))
  ;Enhanced security when the application is running in the browser (Adobe Reader 9+)
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnhancedSecurityInBrowser', Number('1'))
  ;Enhanced security for the standalone application
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnhancedSecurityStandalone', Number('1'))
  ;Enable Protected View for Outlook attachments Adobe Reader 10.1+
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnableAlwaysOutlookAttachmentProtectedView', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'iProtectedView', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnhancedSecurityInBrowser', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnhancedSecurityStandalone', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnableAlwaysOutlookAttachmentProtectedView', Number('0'))

  ;Block non-PDF attachments in their native (external) application
  ;Disables opening non-PDF attachments in their native application.
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\Originals', 'bAllowOpenFile', Number('0'))
  ;Disables opening attachments which are not PDF
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\11.0\Originals', 'bSecureOpenFile', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\Originals', 'bAllowOpenFile', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_AdobeAcrobatReader & '\DC\Originals', 'bSecureOpenFile', Number('1'))

   If $n = $NumberOfSettings Then Return 'ON'
   If _RegValueEqualTo('HKCU\SOFTWARE\Adobe\Acrobat Reader\DC\Privileged', 'bProtectedMode', Number('1')) =1 Then $m= $m + 1
   If _RegValueEqualTo('HKCU\SOFTWARE\Adobe\Acrobat Reader\11.0\Privileged', 'bProtectedMode', Number('1')) =1 Then $m= $m + 1
   If $n = 0  Then Return 'OFF'
;  Poprawka na domyœlne ustawienia
   If ($n = 2 and $m = 2) Then Return 'OFF'
; Non-proper settings
   If ($n < 0 or $n > $NumberOfSettings) Then Return '?'
; In other cases
   Return 'Partial'
EndFunc


Func CheckCurrentAccountDocumentMSOAntiExploit()
   Local $HKU_MSOfficePolicies = 'HKU\' & _GetCurrentUserSID() & '\Software\Policies\Microsoft\Office'
   Local $HKU_MSOffice = 'HKU\' & _GetCurrentUserSID() & '\Software\Microsoft\Office'
   Local $NumberOfSettings = 124
   Local $n = 0
   Local $m = 0
  ;Disabling TrustCenter blocking notifications (TrustBar)
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\common\TrustCenter', 'TrustBar', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\common\TrustCenter', 'TrustBar', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\common\TrustCenter', 'TrustBar', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\common\TrustCenter', 'TrustBar', Number('1'))

  ;Disabling DDE in Word 2007+, introduced via Windows Updates in january 2018 (Security Advisory ADV170021)
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Word\Security', 'AllowDDE', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Word\Security', 'AllowDDE', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Word\Security', 'AllowDDE', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Word\Security', 'AllowDDE', Number('0'))

  ;Disabling Macros in MS Office XP and 2003+ (Word, Excel, PowerPoint, Access, Publisher, Outlook)
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\Word\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\Word\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Word\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Word\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Word\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Word\Security', 'VBAWarnings', Number('4'))

   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\Excel\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\Excel\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Excel\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Security', 'VBAWarnings', Number('4'))

   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\PowerPoint\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\PowerPoint\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\PowerPoint\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\PowerPoint\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\PowerPoint\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\PowerPoint\Security', 'VBAWarnings', Number('4'))

   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\Access\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\Access\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Access\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Access\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Access\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Access\Security', 'VBAWarnings', Number('4'))

   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\Publisher\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\Publisher\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Publisher\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Publisher\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Publisher\Security', 'VBAWarnings', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Publisher\Security', 'VBAWarnings', Number('4'))

   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\Outlook\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\Outlook\Security', 'Level', Number('3'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Outlook\Security', 'Level', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Outlook\Security', 'Level', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Outlook\Security', 'Level', Number('4'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Outlook\Security', 'Level', Number('4'))

  ;Disabling auto-update for any linked fields, including DDE, OLE. Links may be updated manually by the user
  ;Excel 2007+
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Excel\Security', 'WorkbookLinkWarnings', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Excel\Security', 'DataConnectionWarnings', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Excel\Security', 'DisableDDEServerLaunch', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Excel\Security', 'DisableDDEServerLookup', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Excel\Options', 'Options5', Number('129'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Security', 'WorkbookLinkWarnings', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Security', 'DataConnectionWarnings', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Security', 'DisableDDEServerLaunch', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Security', 'DisableDDEServerLookup', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Options', 'DDEAllowed', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Options', 'DDECleaned', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Options', 'DontUpdateLinks', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Security', 'WorkbookLinkWarnings', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Security', 'DataConnectionWarnings', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Security', 'DisableDDEServerLaunch', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Security', 'DisableDDEServerLookup', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Options', 'DDEAllowed', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Options', 'DDECleaned', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Options', 'DontUpdateLinks', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Security', 'WorkbookLinkWarnings', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Security', 'DataConnectionWarnings', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Security', 'DisableDDEServerLaunch', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Security', 'DisableDDEServerLookup', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Options', 'DDEAllowed', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Options', 'DDECleaned', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Options', 'DontUpdateLinks', Number('1'))

  ;Outlook 2010+
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Word\Options\WordMail', 'DontUpdateLinks', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Word\Options\WordMail', 'DontUpdateLinks', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Word\Options\WordMail', 'DontUpdateLinks', Number('1'))

  ;Word and Outlook 2007
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Word\Options\vpref', 'fNoCalclinksOnopen_90_1', Number('1'))

  ;Word 2010+
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Word\Options', 'DontUpdateLinks', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Word\Options', 'DontUpdateLinks', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Word\Options', 'DontUpdateLinks', Number('1'))
  ;One Note
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\OneNote\Options', 'DisableEmbeddedFiles', Number('1'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\OneNote\Options', 'DisableEmbeddedFiles', Number('1'))


  ;Block Access to Visual Basic Object Model (VBOM) in MS Access, Microsoft Excel, Microsoft PowerPoint, and Microsoft Word
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Access\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Access\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Access\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Access\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\Access\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\Access\Security', 'AccessVBOM', Number('0'))

   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Word\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Word\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Word\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Word\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\Word\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\Word\Security', 'AccessVBOM', Number('0'))

   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Excel\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\Excel\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\Excel\Security', 'AccessVBOM', Number('0'))

   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\11.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\10.0\PowerPoint\Security', 'AccessVBOM', Number('0'))

  ; Block "Run Programs" option for action buttons in PowerPoint 2007+.  
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\PowerPoint\Security', 'RunPrograms', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\PowerPoint\Security', 'RunPrograms', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\PowerPoint\Security', 'RunPrograms', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\PowerPoint\Security', 'RunPrograms', Number('0'))

  ; Block automatic download of linked images in PowerPoint 2007+ (Windows 7+). 
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\PowerPoint\Security', 'DownloadImages', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\PowerPoint\Security', 'DownloadImages', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\PowerPoint\Security', 'DownloadImages', Number('0'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\PowerPoint\Security', 'DownloadImages', Number('0'))

  ;ActiveX
  ;Block ActiveX in Office 2007+ (can be run only from secure locations)
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\Common\Security', 'DisableAllActiveX', Number('1'))

  ;OLE
  ;Block OLE in Office 2007+
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Word\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\Excel\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\12.0\PowerPoint\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Word\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\Excel\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\14.0\PowerPoint\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Word\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\Excel\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\15.0\PowerPoint\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Word\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\Excel\Security', 'PackagerPrompt', Number('2'))
   $n = $n + _RegValueEqualTo($HKU_MSOffice & '\16.0\PowerPoint\Security', 'PackagerPrompt', Number('2'))
;*********************************
;*********************************

  ;Disabling TrustCenter blocking notifications (TrustBar)
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\common\TrustCenter', 'TrustBar', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\common\TrustCenter', 'TrustBar', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\common\TrustCenter', 'TrustBar', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\common\TrustCenter', 'TrustBar', Number('1'))

  ;Disabling DDE in Word 2007+, introduced via Windows Updates in january 2018 (Security Advisory ADV170021)
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Word\Security', 'AllowDDE', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Word\Security', 'AllowDDE', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Word\Security', 'AllowDDE', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Word\Security', 'AllowDDE', Number('0'))

  ;Disabling Macros in MS Office XP and 2003+ (Word, Excel, PowerPoint, Access, Publisher, Outlook)
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\Word\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\Word\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Word\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Word\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Word\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Word\Security', 'VBAWarnings', Number('4'))

   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\Excel\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\Excel\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'VBAWarnings', Number('4'))

   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\PowerPoint\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\PowerPoint\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'VBAWarnings', Number('4'))

   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\Access\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\Access\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Access\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Access\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Access\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Access\Security', 'VBAWarnings', Number('4'))

   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\Publisher\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\Publisher\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Publisher\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Publisher\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Publisher\Security', 'VBAWarnings', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Publisher\Security', 'VBAWarnings', Number('4'))

   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\Outlook\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\Outlook\Security', 'Level', Number('3'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Outlook\Security', 'Level', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Outlook\Security', 'Level', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Outlook\Security', 'Level', Number('4'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Outlook\Security', 'Level', Number('4'))

  ;Disabling auto-update for any linked fields, including DDE, OLE. Links may be updated manually by the user
  ;Excel 2007+
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'WorkbookLinkWarnings', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DataConnectionWarnings', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DisableDDEServerLaunch', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DisableDDEServerLookup', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Excel\Options', 'Options5', Number('129'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'WorkbookLinkWarnings', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DataConnectionWarnings', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DisableDDEServerLaunch', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DisableDDEServerLookup', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DDEAllowed', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DDECleaned', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DontUpdateLinks', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'WorkbookLinkWarnings', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DataConnectionWarnings', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DisableDDEServerLaunch', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DisableDDEServerLookup', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DDEAllowed', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DDECleaned', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DontUpdateLinks', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'WorkbookLinkWarnings', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DataConnectionWarnings', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DisableDDEServerLaunch', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DisableDDEServerLookup', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DDEAllowed', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DDECleaned', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DontUpdateLinks', Number('1'))

  ;Outlook 2010+
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Word\Options\WordMail', 'DontUpdateLinks', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Word\Options\WordMail', 'DontUpdateLinks', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Word\Options\WordMail', 'DontUpdateLinks', Number('1'))

  ;Word and Outlook 2007
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Word\Options\vpref', 'fNoCalclinksOnopen_90_1', Number('1'))

  ;Word 2010+
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Word\Options', 'DontUpdateLinks', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Word\Options', 'DontUpdateLinks', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Word\Options', 'DontUpdateLinks', Number('1'))
  ;One Note
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\OneNote\Options', 'DisableEmbeddedFiles', Number('1'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\OneNote\Options', 'DisableEmbeddedFiles', Number('1'))


  ;Block Access to Visual Basic Object Model (VBOM) in MS Access, Microsoft Excel, Microsoft PowerPoint, and Microsoft Word
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Access\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Access\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Access\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Access\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\Access\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\Access\Security', 'AccessVBOM', Number('0'))

   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Word\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Word\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Word\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Word\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\Word\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\Word\Security', 'AccessVBOM', Number('0'))

   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\Excel\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\Excel\Security', 'AccessVBOM', Number('0'))

   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\11.0\PowerPoint\Security', 'AccessVBOM', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\10.0\PowerPoint\Security', 'AccessVBOM', Number('0'))

  ; Block "Run Programs" option for action buttons in PowerPoint 2007+.  
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'RunPrograms', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'RunPrograms', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'RunPrograms', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'RunPrograms', Number('0'))

  ; Block automatic download of linked images in PowerPoint 2007+ (Windows 7+). 
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'DownloadImages', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'DownloadImages', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'DownloadImages', Number('0'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'DownloadImages', Number('0'))

  ;ActiveX
  ;Block ActiveX in Office 2007+ (can be run only from secure locations)
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\Common\Security', 'DisableAllActiveX', Number('1'))

  ;OLE
  ;Block OLE in Office 2007+
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Word\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Word\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Word\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Word\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'PackagerPrompt', Number('2'))
   $m = $m + _RegValueEqualTo($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'PackagerPrompt', Number('2'))

;MsgBox(0,"", "Wynik" & @crlf & $n & @crlf & $m)
; Do not change the order of the below inequalities
   If ($m < 0 or $m > $NumberOfSettings) Then Return '?'
   If ($n < 0 or $n > $NumberOfSettings) Then Return '?'
   If ($n = 0 And $m = 0) Then Return 'OFF'
   If $m = $NumberOfSettings Then Return 'ON2'
   If $n = $NumberOfSettings Then Return 'ON1'
; The last non-proper settings
   Return 'Partial'
EndFunc



Func CurrentAccountDocumentsAARAntiExploit1($DAEflag)
Local $HKU_AdobeAcrobatReader = 'HKU\' & _GetCurrentUserSID() & '\Software\Adobe\Acrobat Reader'
If $DAEflag = "Partial" Then
   MsgBox(262144, "", "The <Adobe Acrobat Reader> setting in the profile is equal to 'Partial'. It could be set so, only via the external program. You can change it by choosing one of the available options in <Adobe Acrobat Reader> feature.")
   Return
EndIf

Switch $DAEflag
case 'ON'
  ;Block JavaScript in Adobe Reader DC and Adobe Reader XI
  ;Block scripts
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\JSPrefs', 'bEnableJS','REG_DWORD',Number('0'))
  ;Script in one sandbox cannot access a script object in another sandbox
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\JSPrefs', 'bEnableGlobalSecurity','REG_DWORD',Number('1'))
   RegWrite($HKU_AdobeAcrobatReader & '\DC\JSPrefs', 'bEnableJS','REG_DWORD',Number('0'))
   RegWrite($HKU_AdobeAcrobatReader & '\DC\JSPrefs', 'bEnableGlobalSecurity','REG_DWORD',Number('1'))

  ;Adobe Acrobat 10+ Enables Protected Mode and thereby sandboxes Reader processes
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\Privileged', 'bProtectedMode','REG_DWORD',Number('1'))
   RegWrite($HKU_AdobeAcrobatReader & '\DC\Privileged', 'bProtectedMode','REG_DWORD',Number('1'))
   RegWrite($HKU_AdobeAcrobatReader & '\DC\Privileged', 'bEnableProtectedModeAppContainer','REG_DWORD',Number('1'))

  ;Turns on Protected View
   RegWrite($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'iProtectedView','REG_DWORD',Number('2'))
  ;Enhanced security when the application is running in the browser (Adobe Reader 9+)
   RegWrite($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnhancedSecurityInBrowser','REG_DWORD',Number('1'))
  ;Enhanced security for the standalone application
   RegWrite($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnhancedSecurityStandalone','REG_DWORD',Number('1'))
  ;Enable Protected View for Outlook attachments Adobe Reader 10.1+
   RegWrite($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnableAlwaysOutlookAttachmentProtectedView','REG_DWORD',Number('0'))
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'iProtectedView','REG_DWORD',Number('2'))
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnhancedSecurityInBrowser','REG_DWORD',Number('1'))
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnhancedSecurityStandalone','REG_DWORD',Number('1'))
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnableAlwaysOutlookAttachmentProtectedView','REG_DWORD',Number('0'))

  ;Block non-PDF attachments in their native (external) application
  ;Disables opening non-PDF attachments in their native application.
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\Originals', 'bAllowOpenFile','REG_DWORD',Number('0'))
  ;Disables opening attachments which are not PDF
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\Originals', 'bSecureOpenFile','REG_DWORD',Number('1'))
   RegWrite($HKU_AdobeAcrobatReader & '\DC\Originals', 'bAllowOpenFile','REG_DWORD',Number('0'))
   RegWrite($HKU_AdobeAcrobatReader & '\DC\Originals', 'bSecureOpenFile','REG_DWORD',Number('1'))

case 'OFF'
   DeleteHKUAdobeAcrobatReader()
Case Else
   MsgBox(0, "Adobe Acrobat Reader Documents Anti-Exploit", "Error - Wrong setting.")
EndSwitch
EndFunc



Func CurrentAccountDocumentsMSOAntiExploit1($DAEflag)
Local $HKU_MSOfficePolicies = 'HKU\' & _GetCurrentUserSID() & '\Software\Policies\Microsoft\Office'
Local $HKU_MSOffice = 'HKU\' & _GetCurrentUserSID() & '\Software\Microsoft\Office'

If $DAEflag = "Partial" Then
   MsgBox(262144, "", "The <MS Office> setting in the profile is equal to 'Partial'. It could be set so, only via the external program. You can change it by choosing one of the available options in <MS Office> feature.")
   Return
EndIf

Switch $DAEflag

; Enabling Non-Policies restrictions
 Case "ON1"
; Deleting possible Policies, so applied below restrictions can be configurable in MS Office applications
  DeleteHKUMSOfficePolicies()

  ;Disabling TrustCenter blocking notifications (TrustBar)
   RegWrite($HKU_MSOffice & '\12.0\common\TrustCenter', 'TrustBar','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\14.0\common\TrustCenter', 'TrustBar','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\15.0\common\TrustCenter', 'TrustBar','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\16.0\common\TrustCenter', 'TrustBar','REG_DWORD',Number('1'))

  ;Disabling DDE (introduced via Windows Update in january 2018) Word 2007+, 
   RegWrite($HKU_MSOffice & '\12.0\Word\Security', 'AllowDDE','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\14.0\Word\Security', 'AllowDDE','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\15.0\Word\Security', 'AllowDDE','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\16.0\Word\Security', 'AllowDDE','REG_DWORD',Number('0'))

  ;Disabling Macros in MS Office XP and 2003+ (Word, Excel, PowerPoint, Access, Publisher, Outlook)
   RegWrite($HKU_MSOffice & '\10.0\Word\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\11.0\Word\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\12.0\Word\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\14.0\Word\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\15.0\Word\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\16.0\Word\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOffice & '\10.0\Excel\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\11.0\Excel\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\12.0\Excel\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOffice & '\10.0\PowerPoint\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\11.0\PowerPoint\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\12.0\PowerPoint\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\14.0\PowerPoint\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\15.0\PowerPoint\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\16.0\PowerPoint\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOffice & '\10.0\Access\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\11.0\Access\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\12.0\Access\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\14.0\Access\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\15.0\Access\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\16.0\Access\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOffice & '\10.0\Publisher\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\11.0\Publisher\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\12.0\Publisher\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\14.0\Publisher\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\15.0\Publisher\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\16.0\Publisher\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOffice & '\10.0\Outlook\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\11.0\Outlook\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOffice & '\12.0\Outlook\Security', 'Level','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\14.0\Outlook\Security', 'Level','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\15.0\Outlook\Security', 'Level','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOffice & '\16.0\Outlook\Security', 'Level','REG_DWORD',Number('4'))

  ;Disabling auto-update for any linked fields, including DDE, OLE. Links may be updated manually by the user
  ;Excel 2007+
   RegWrite($HKU_MSOffice & '\12.0\Excel\Security', 'WorkbookLinkWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\12.0\Excel\Security', 'DataConnectionWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\12.0\Excel\Security', 'DisableDDEServerLaunch','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\12.0\Excel\Security', 'DisableDDEServerLookup','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\12.0\Excel\Options', 'Options5','REG_DWORD',Number('129'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Security', 'WorkbookLinkWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Security', 'DataConnectionWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Security', 'DisableDDEServerLaunch','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Security', 'DisableDDEServerLookup','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Options', 'DDEAllowed','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Options', 'DDECleaned','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Security', 'WorkbookLinkWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Security', 'DataConnectionWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Security', 'DisableDDEServerLaunch','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Security', 'DisableDDEServerLookup','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Options', 'DDEAllowed','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Options', 'DDECleaned','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Security', 'WorkbookLinkWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Security', 'DataConnectionWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Security', 'DisableDDEServerLaunch','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Security', 'DisableDDEServerLookup','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Options', 'DDEAllowed','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Options', 'DDECleaned','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))

  ;Outlook 2010+
   RegWrite($HKU_MSOffice & '\14.0\Word\Options\WordMail', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\15.0\Word\Options\WordMail', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\16.0\Word\Options\WordMail', 'DontUpdateLinks','REG_DWORD',Number('1'))

  ;Word and Outlook 2007
   RegWrite($HKU_MSOffice & '\12.0\Word\Options\vpref', 'fNoCalclinksOnopen_90_1','REG_DWORD',Number('1'))

  ;Word 2010+
   RegWrite($HKU_MSOffice & '\14.0\Word\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\15.0\Word\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\16.0\Word\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
  ;One Note
   RegWrite($HKU_MSOffice & '\16.0\OneNote\Options', 'DisableEmbeddedFiles','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOffice & '\15.0\OneNote\Options', 'DisableEmbeddedFiles','REG_DWORD',Number('1'))

  ;Block Access to Visual Basic Object Model (VBOM) in MS Access, Microsoft Excel, Microsoft PowerPoint, and Microsoft Word
   RegWrite($HKU_MSOffice & '\16.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\15.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\14.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\12.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\11.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\10.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))

   RegWrite($HKU_MSOffice & '\16.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\15.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\14.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\12.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\11.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\10.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))

   RegWrite($HKU_MSOffice & '\16.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\12.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\11.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\10.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))

   RegWrite($HKU_MSOffice & '\16.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\15.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\14.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\12.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\11.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\10.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))

  ; Block "Run Programs" option for action buttons in PowerPoint 2007+.  
   RegWrite($HKU_MSOffice & '\16.0\PowerPoint\Security', 'RunPrograms','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\15.0\PowerPoint\Security', 'RunPrograms','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\14.0\PowerPoint\Security', 'RunPrograms','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\12.0\PowerPoint\Security', 'RunPrograms','REG_DWORD',Number('0'))

  ; Block automatic download of linked images in PowerPoint 2007+ (Windows 7+). 
   RegWrite($HKU_MSOffice & '\16.0\PowerPoint\Security', 'DownloadImages','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\15.0\PowerPoint\Security', 'DownloadImages','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\14.0\PowerPoint\Security', 'DownloadImages','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOffice & '\12.0\PowerPoint\Security', 'DownloadImages','REG_DWORD',Number('0'))

  ;ActiveX
  ;Block ActiveX in Office 2007+ (can be run only from secure locations)
   RegWrite($HKU_MSOffice & '\Common\Security', 'DisableAllActiveX','REG_DWORD',Number('1'))

  ;OLE
  ;Block OLE in Office 2007+

   RegWrite($HKU_MSOffice & '\12.0\Word\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\12.0\Excel\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\12.0\PowerPoint\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\14.0\Word\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\14.0\Excel\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\14.0\PowerPoint\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\15.0\Word\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\15.0\Excel\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\15.0\PowerPoint\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\16.0\Word\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\16.0\Excel\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOffice & '\16.0\PowerPoint\Security', 'PackagerPrompt','REG_DWORD',Number('2'))

;Enabling restrictions via Windows Policies
 Case "ON2"
  ;Disabling TrustCenter blocking notifications (TrustBar)
   RegWrite($HKU_MSOfficePolicies & '\12.0\common\TrustCenter', 'TrustBar','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\common\TrustCenter', 'TrustBar','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\common\TrustCenter', 'TrustBar','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\common\TrustCenter', 'TrustBar','REG_DWORD',Number('1'))

  ;Disabling DDE (introduced via Windows Update in january 2018) Word 2007+, 
   RegWrite($HKU_MSOfficePolicies & '\12.0\Word\Security', 'AllowDDE','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Word\Security', 'AllowDDE','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Word\Security', 'AllowDDE','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Word\Security', 'AllowDDE','REG_DWORD',Number('0'))

  ;Disabling Macros in MS Office XP and 2003+ (Word, Excel, PowerPoint, Access, Publisher, Outlook)
   RegWrite($HKU_MSOfficePolicies & '\10.0\Word\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\Word\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Word\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Word\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Word\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Word\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOfficePolicies & '\10.0\Excel\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\Excel\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOfficePolicies & '\10.0\PowerPoint\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\PowerPoint\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOfficePolicies & '\10.0\Access\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\Access\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Access\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Access\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Access\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Access\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOfficePolicies & '\10.0\Publisher\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\Publisher\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Publisher\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Publisher\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Publisher\Security', 'VBAWarnings','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Publisher\Security', 'VBAWarnings','REG_DWORD',Number('4'))

   RegWrite($HKU_MSOfficePolicies & '\10.0\Outlook\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\Outlook\Security', 'Level','REG_DWORD',Number('3'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Outlook\Security', 'Level','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Outlook\Security', 'Level','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Outlook\Security', 'Level','REG_DWORD',Number('4'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Outlook\Security', 'Level','REG_DWORD',Number('4'))

  ;Disabling auto-update for any linked fields, including DDE, OLE. Links may be updated manually by the user
  ;Excel 2007+
   RegWrite($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'WorkbookLinkWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DataConnectionWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DisableDDEServerLaunch','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DisableDDEServerLookup','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Excel\Options', 'Options5','REG_DWORD',Number('129'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'WorkbookLinkWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DataConnectionWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DisableDDEServerLaunch','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DisableDDEServerLookup','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DDEAllowed','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DDECleaned','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'WorkbookLinkWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DataConnectionWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DisableDDEServerLaunch','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DisableDDEServerLookup','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DDEAllowed','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DDECleaned','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'WorkbookLinkWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DataConnectionWarnings','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DisableDDEServerLaunch','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DisableDDEServerLookup','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DDEAllowed','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DDECleaned','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))

  ;Outlook 2010+
   RegWrite($HKU_MSOfficePolicies & '\14.0\Word\Options\WordMail', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Word\Options\WordMail', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Word\Options\WordMail', 'DontUpdateLinks','REG_DWORD',Number('1'))

  ;Word and Outlook 2007
   RegWrite($HKU_MSOfficePolicies & '\12.0\Word\Options\vpref', 'fNoCalclinksOnopen_90_1','REG_DWORD',Number('1'))

  ;Word 2010+
   RegWrite($HKU_MSOfficePolicies & '\14.0\Word\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Word\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Word\Options', 'DontUpdateLinks','REG_DWORD',Number('1'))

  ;One Note
   RegWrite($HKU_MSOfficePolicies & '\16.0\OneNote\Options', 'DisableEmbeddedFiles','REG_DWORD',Number('1'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\OneNote\Options', 'DisableEmbeddedFiles','REG_DWORD',Number('1'))

  ;Block Access to Visual Basic Object Model (VBOM) in MS Access, Microsoft Excel, Microsoft PowerPoint, and Microsoft Word
   RegWrite($HKU_MSOfficePolicies & '\16.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\10.0\Access\Security', 'AccessVBOM','REG_DWORD',Number('0'))

   RegWrite($HKU_MSOfficePolicies & '\16.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\10.0\Word\Security', 'AccessVBOM','REG_DWORD',Number('0'))

   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\10.0\Excel\Security', 'AccessVBOM','REG_DWORD',Number('0'))

   RegWrite($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\11.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\10.0\PowerPoint\Security', 'AccessVBOM','REG_DWORD',Number('0'))

  ; Block "Run Programs" option for action buttons in PowerPoint 2007+.  
   RegWrite($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'RunPrograms','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'RunPrograms','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'RunPrograms','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'RunPrograms','REG_DWORD',Number('0'))

  ; Block automatic download of linked images in PowerPoint 2007+ (Windows 7+). 
   RegWrite($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'DownloadImages','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'DownloadImages','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'DownloadImages','REG_DWORD',Number('0'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'DownloadImages','REG_DWORD',Number('0'))

  ;ActiveX
  ;Block ActiveX in Office 2007+ (can be run only from secure locations)
   RegWrite($HKU_MSOfficePolicies & '\Common\Security', 'DisableAllActiveX','REG_DWORD',Number('1'))

  ;OLE
  ;Block OLE in Office 2007+

   RegWrite($HKU_MSOfficePolicies & '\12.0\Word\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Word\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Word\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Word\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'PackagerPrompt','REG_DWORD',Number('2'))
   RegWrite($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'PackagerPrompt','REG_DWORD',Number('2'))


; Delete Policies and Non-Policies security settings
Case 'OFF'
   DeleteHKUMSOfficePolicies()
   DeleteHKUMSOffice()
Case 'OFF2'
   DeleteHKUMSOfficePolicies()
Case Else
   MsgBox(0, "MS Office Documents Anti-Exploit", "Error - Wrong setting.")
EndSwitch

EndFunc


Func DeleteHKUMSOfficePolicies()
Local $HKU_MSOfficePolicies = 'HKU\' & _GetCurrentUserSID() & '\Software\Policies\Microsoft\Office'
; Delete Policies security settings
  ;Enabling TrustCenter blocking notifications (TrustBar)
   RegDelete($HKU_MSOfficePolicies & '\12.0\common\TrustCenter')
   RegDelete($HKU_MSOfficePolicies & '\14.0\common\TrustCenter')
   RegDelete($HKU_MSOfficePolicies & '\15.0\common\TrustCenter')
   RegDelete($HKU_MSOfficePolicies & '\16.0\common\TrustCenter')
  ;Word 2007+, introduced via Windows Update in january 2018
   RegDelete($HKU_MSOfficePolicies & '\12.0\Word\Security', 'AllowDDE')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Word\Security', 'AllowDDE')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Word\Security', 'AllowDDE')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Word\Security', 'AllowDDE')

  ;Default Macro settings in MS Office XP and 2003+ (Word, Excel, PowerPoint, Access, Publisher, Outlook)
   RegDelete($HKU_MSOfficePolicies & '\10.0\Word\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Word\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Word\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Word\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Word\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Word\Security', 'VBAWarnings')

   RegDelete($HKU_MSOfficePolicies & '\10.0\Excel\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Excel\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'VBAWarnings')

   RegDelete($HKU_MSOfficePolicies & '\10.0\PowerPoint\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\11.0\PowerPoint\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'VBAWarnings')

   RegDelete($HKU_MSOfficePolicies & '\10.0\Access\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Access\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Access\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Access\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Access\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Access\Security', 'VBAWarnings')

   RegDelete($HKU_MSOfficePolicies & '\10.0\Publisher\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Publisher\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Publisher\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Publisher\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Publisher\Security', 'VBAWarnings')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Publisher\Security', 'VBAWarnings')

   RegDelete($HKU_MSOfficePolicies & '\10.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Outlook\Security', 'Level')

  ;Excel 2007+
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'WorkbookLinkWarnings')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DataConnectionWarnings')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DisableDDEServerLaunch')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'DisableDDEServerLookup')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Options', 'Options5')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'WorkbookLinkWarnings')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DataConnectionWarnings')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DisableDDEServerLaunch')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'DisableDDEServerLookup')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DDEAllowed')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DDECleaned')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'DontUpdateLinks')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Options', 'Options')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'WorkbookLinkWarnings')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DataConnectionWarnings')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DisableDDEServerLaunch')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'DisableDDEServerLookup')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DDEAllowed')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DDECleaned')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'DontUpdateLinks')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Options', 'Options')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'WorkbookLinkWarnings')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DataConnectionWarnings')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DisableDDEServerLaunch')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'DisableDDEServerLookup')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DDEAllowed')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DDECleaned')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Options', 'DontUpdateLinks')
;CheckDocumentsAntiExploit()
  ;Outlook 2010+
   RegDelete($HKU_MSOfficePolicies & '\14.0\Word\Options\WordMail', 'DontUpdateLinks')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Word\Options\WordMail', 'DontUpdateLinks')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Word\Options\WordMail', 'DontUpdateLinks')
  ;Word and Outlook 2007
   RegDelete($HKU_MSOfficePolicies & '\12.0\Word\Options\vpref', 'fNoCalclinksOnopen_90_1')
  ;Word 2010+
   RegDelete($HKU_MSOfficePolicies & '\14.0\Word\Options', 'DontUpdateLinks')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Word\Options', 'DontUpdateLinks')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Word\Options', 'DontUpdateLinks')
  ;One Note
   RegDelete($HKU_MSOfficePolicies & '\16.0\OneNote\Options', 'DisableEmbeddedFiles')
   RegDelete($HKU_MSOfficePolicies & '\15.0\OneNote\Options', 'DisableEmbeddedFiles')


   RegDelete($HKU_MSOfficePolicies & '\16.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\10.0\Access\Security', 'AccessVBOM')

   RegDelete($HKU_MSOfficePolicies & '\16.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\10.0\Word\Security', 'AccessVBOM')

   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\10.0\Excel\Security', 'AccessVBOM')

   RegDelete($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\11.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\10.0\PowerPoint\Security', 'AccessVBOM')

   RegDelete($HKU_MSOfficePolicies & '\16.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\10.0\Access\Security', 'AccessVBOM')

   RegDelete($HKU_MSOfficePolicies & '\16.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\10.0\Word\Security', 'AccessVBOM')

   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\11.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\10.0\Excel\Security', 'AccessVBOM')

   RegDelete($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\11.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOfficePolicies & '\10.0\PowerPoint\Security', 'AccessVBOM')

  ; UnBlock "Run Programs" option for action buttons in PowerPoint 2007+.  
   RegDelete($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'RunPrograms')
   RegDelete($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'RunPrograms')
   RegDelete($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'RunPrograms')
   RegDelete($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'RunPrograms')

  ; UnBlock automatic download of linked images in PowerPoint 2007+ (Windows 7+). 
   RegDelete($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'DownloadImages')
   RegDelete($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'DownloadImages')
   RegDelete($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'DownloadImages')
   RegDelete($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'DownloadImages')

  ;ActiveX
  ;ActiveX in Office 2007+ (can be run only from secure locations)
   RegDelete($HKU_MSOfficePolicies & '\Common\Security', 'DisableAllActiveX')

  ;OLE
  ;OLE in Office 2007+
   RegDelete($HKU_MSOfficePolicies & '\12.0\Word\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\12.0\Excel\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\12.0\PowerPoint\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Word\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\14.0\Excel\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\14.0\PowerPoint\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Word\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\15.0\Excel\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\15.0\PowerPoint\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Word\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\16.0\Excel\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOfficePolicies & '\16.0\PowerPoint\Security', 'PackagerPrompt')

EndFunc


Func DeleteHKUAdobeAcrobatReader()
  Local $HKU_AdobeAcrobatReader = 'HKU\' & _GetCurrentUserSID() & '\Software\Adobe\Acrobat Reader'
;  JavaScript in Adobe Reader DC and Adobe Reader XI
   RegDelete($HKU_AdobeAcrobatReader & '\11.0\JSPrefs', 'bEnableJS')
;  Script in one sandbox cannot access a script object in another sandbox
   RegDelete($HKU_AdobeAcrobatReader & '\11.0\JSPrefs', 'bEnableGlobalSecurity')
   RegDelete($HKU_AdobeAcrobatReader & '\DC\JSPrefs', 'bEnableJS')
   RegDelete($HKU_AdobeAcrobatReader & '\DC\JSPrefs', 'bEnableGlobalSecurity')
;  Adobe Acrobat 10+ - Protected Mode and thereby sandboxes Reader processes
;  'bProtectedMode' is the default setting in Adobe Acrobat Reader XI and DC
;   RegDelete($HKU_AdobeAcrobatReader & '\11.0\Privileged', 'bProtectedMode')
;   RegDelete($HKU_AdobeAcrobatReader & '\DC\Privileged', 'bProtectedMode')
   RegDelete($HKU_AdobeAcrobatReader & '\DC\Privileged', 'bEnableProtectedModeAppContainer')
  ;Protected View
   RegDelete($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'iProtectedView')
  ;Enhanced security when the application is running in the browser (Adobe Reader 9+)
   RegDelete($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnhancedSecurityInBrowser')
  ;Enhanced security for the standalone application
   RegDelete($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnhancedSecurityStandalone')
  ;Protected View for Outlook attachments Adobe Reader 10.1+
   RegDelete($HKU_AdobeAcrobatReader & '\DC\TrustManager', 'bEnableAlwaysOutlookAttachmentProtectedView')
   RegDelete($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'iProtectedView')
   RegDelete($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnhancedSecurityInBrowser')
   RegDelete($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnhancedSecurityStandalone')
   RegDelete($HKU_AdobeAcrobatReader & '\11.0\TrustManager', 'bEnableAlwaysOutlookAttachmentProtectedView')
  ;non-PDF attachments in their native (external) application
  ;opening non-PDF attachments in their native application.
   RegDelete($HKU_AdobeAcrobatReader & '\11.0\Originals', 'bAllowOpenFile')
  ;opening attachments which are not PDF
   RegDelete($HKU_AdobeAcrobatReader & '\11.0\Originals', 'bSecureOpenFile')
   RegDelete($HKU_AdobeAcrobatReader & '\DC\Originals', 'bAllowOpenFile')
   RegDelete($HKU_AdobeAcrobatReader & '\DC\Originals', 'bSecureOpenFile')
   RegWrite($HKU_AdobeAcrobatReader & '\DC\Privileged', 'bProtectedMode','REG_DWORD',Number('1'))
   RegWrite($HKU_AdobeAcrobatReader & '\11.0\Privileged', 'bProtectedMode','REG_DWORD',Number('1'))
EndFunc




Func DeleteHKUMSOffice()
   Local $HKU_MSOffice = 'HKU\' & _GetCurrentUserSID() & '\Software\Microsoft\Office'
; Delete non policies settings
  ;Enabling TrustCenter blocking notifications (TrustBar)
   RegDelete($HKU_MSOffice & '\12.0\common\TrustCenter')
   RegDelete($HKU_MSOffice & '\14.0\common\TrustCenter')
   RegDelete($HKU_MSOffice & '\15.0\common\TrustCenter')
   RegDelete($HKU_MSOffice & '\16.0\common\TrustCenter')
  ;Word 2007+, introduced via Windows Update in january 2018
   RegDelete($HKU_MSOffice & '\12.0\Word\Security', 'AllowDDE')
   RegDelete($HKU_MSOffice & '\14.0\Word\Security', 'AllowDDE')
   RegDelete($HKU_MSOffice & '\15.0\Word\Security', 'AllowDDE')
   RegDelete($HKU_MSOffice & '\16.0\Word\Security', 'AllowDDE')

  ;Default Macro settings in MS Office XP and 2003+ (Word, Excel, PowerPoint, Access, Publisher, Outlook)
   RegDelete($HKU_MSOffice & '\10.0\Word\Security', 'Level')
   RegDelete($HKU_MSOffice & '\11.0\Word\Security', 'Level')
   RegDelete($HKU_MSOffice & '\12.0\Word\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\14.0\Word\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\15.0\Word\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\16.0\Word\Security', 'VBAWarnings')

   RegDelete($HKU_MSOffice & '\10.0\Excel\Security', 'Level')
   RegDelete($HKU_MSOffice & '\11.0\Excel\Security', 'Level')
   RegDelete($HKU_MSOffice & '\12.0\Excel\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Security', 'VBAWarnings')

   RegDelete($HKU_MSOffice & '\10.0\PowerPoint\Security', 'Level')
   RegDelete($HKU_MSOffice & '\11.0\PowerPoint\Security', 'Level')
   RegDelete($HKU_MSOffice & '\12.0\PowerPoint\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\14.0\PowerPoint\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\15.0\PowerPoint\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\16.0\PowerPoint\Security', 'VBAWarnings')

   RegDelete($HKU_MSOffice & '\10.0\Access\Security', 'Level')
   RegDelete($HKU_MSOffice & '\11.0\Access\Security', 'Level')
   RegDelete($HKU_MSOffice & '\12.0\Access\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\14.0\Access\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\15.0\Access\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\16.0\Access\Security', 'VBAWarnings')

   RegDelete($HKU_MSOffice & '\10.0\Publisher\Security', 'Level')
   RegDelete($HKU_MSOffice & '\11.0\Publisher\Security', 'Level')
   RegDelete($HKU_MSOffice & '\12.0\Publisher\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\14.0\Publisher\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\15.0\Publisher\Security', 'VBAWarnings')
   RegDelete($HKU_MSOffice & '\16.0\Publisher\Security', 'VBAWarnings')

   RegDelete($HKU_MSOffice & '\10.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOffice & '\11.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOffice & '\12.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOffice & '\14.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOffice & '\15.0\Outlook\Security', 'Level')
   RegDelete($HKU_MSOffice & '\16.0\Outlook\Security', 'Level')

  ;Excel 2007+
   RegDelete($HKU_MSOffice & '\12.0\Excel\Security', 'WorkbookLinkWarnings')
   RegDelete($HKU_MSOffice & '\12.0\Excel\Security', 'DataConnectionWarnings')
   RegDelete($HKU_MSOffice & '\12.0\Excel\Security', 'DisableDDEServerLaunch')
   RegDelete($HKU_MSOffice & '\12.0\Excel\Security', 'DisableDDEServerLookup')
   RegDelete($HKU_MSOffice & '\12.0\Excel\Options', 'Options5')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Security', 'WorkbookLinkWarnings')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Security', 'DataConnectionWarnings')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Security', 'DisableDDEServerLaunch')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Security', 'DisableDDEServerLookup')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Options', 'DDEAllowed')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Options', 'DDECleaned')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Options', 'DontUpdateLinks')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Options', 'Options')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Security', 'WorkbookLinkWarnings')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Security', 'DataConnectionWarnings')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Security', 'DisableDDEServerLaunch')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Security', 'DisableDDEServerLookup')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Options', 'DDEAllowed')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Options', 'DDECleaned')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Options', 'DontUpdateLinks')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Options', 'Options')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Security', 'WorkbookLinkWarnings')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Security', 'DataConnectionWarnings')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Security', 'DisableDDEServerLaunch')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Security', 'DisableDDEServerLookup')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Options', 'DDEAllowed')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Options', 'DDECleaned')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Options', 'DontUpdateLinks')

  ;Outlook 2010+
   RegDelete($HKU_MSOffice & '\14.0\Word\Options\WordMail', 'DontUpdateLinks')
   RegDelete($HKU_MSOffice & '\15.0\Word\Options\WordMail', 'DontUpdateLinks')
   RegDelete($HKU_MSOffice & '\16.0\Word\Options\WordMail', 'DontUpdateLinks')
  ;Word and Outlook 2007
   RegDelete($HKU_MSOffice & '\12.0\Word\Options\vpref', 'fNoCalclinksOnopen_90_1')
  ;Word 2010+
   RegDelete($HKU_MSOffice & '\14.0\Word\Options', 'DontUpdateLinks')
   RegDelete($HKU_MSOffice & '\15.0\Word\Options', 'DontUpdateLinks')
   RegDelete($HKU_MSOffice & '\16.0\Word\Options', 'DontUpdateLinks')
  ;One Note
   RegDelete($HKU_MSOffice & '\16.0\OneNote\Options', 'DisableEmbeddedFiles')
   RegDelete($HKU_MSOffice & '\15.0\OneNote\Options', 'DisableEmbeddedFiles')


   RegDelete($HKU_MSOffice & '\16.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\15.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\14.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\12.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\11.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\10.0\Access\Security', 'AccessVBOM')

   RegDelete($HKU_MSOffice & '\16.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\15.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\14.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\12.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\11.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\10.0\Word\Security', 'AccessVBOM')

   RegDelete($HKU_MSOffice & '\16.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\12.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\11.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\10.0\Excel\Security', 'AccessVBOM')

   RegDelete($HKU_MSOffice & '\16.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\15.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\14.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\12.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\11.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\10.0\PowerPoint\Security', 'AccessVBOM')

   RegDelete($HKU_MSOffice & '\16.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\15.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\14.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\12.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\11.0\Access\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\10.0\Access\Security', 'AccessVBOM')

   RegDelete($HKU_MSOffice & '\16.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\15.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\14.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\12.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\11.0\Word\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\10.0\Word\Security', 'AccessVBOM')

   RegDelete($HKU_MSOffice & '\16.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\12.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\11.0\Excel\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\10.0\Excel\Security', 'AccessVBOM')

   RegDelete($HKU_MSOffice & '\16.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\15.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\14.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\12.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\11.0\PowerPoint\Security', 'AccessVBOM')
   RegDelete($HKU_MSOffice & '\10.0\PowerPoint\Security', 'AccessVBOM')

  ; UnBlock "Run Programs" option for action buttons in PowerPoint 2007+.  
   RegDelete($HKU_MSOffice & '\16.0\PowerPoint\Security', 'RunPrograms')
   RegDelete($HKU_MSOffice & '\15.0\PowerPoint\Security', 'RunPrograms')
   RegDelete($HKU_MSOffice & '\14.0\PowerPoint\Security', 'RunPrograms')
   RegDelete($HKU_MSOffice & '\12.0\PowerPoint\Security', 'RunPrograms')

  ; UnBlock automatic download of linked images in PowerPoint 2007+ (Windows 7+). 
   RegDelete($HKU_MSOffice & '\16.0\PowerPoint\Security', 'DownloadImages')
   RegDelete($HKU_MSOffice & '\15.0\PowerPoint\Security', 'DownloadImages')
   RegDelete($HKU_MSOffice & '\14.0\PowerPoint\Security', 'DownloadImages')
   RegDelete($HKU_MSOffice & '\12.0\PowerPoint\Security', 'DownloadImages')

  ;ActiveX
  ;ActiveX in Office 2007+ (can be run only from secure locations)
   RegDelete($HKU_MSOffice & '\Common\Security', 'DisableAllActiveX')

  ;OLE
  ;OLE in Office 2007+
   RegDelete($HKU_MSOffice & '\12.0\Word\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\12.0\Excel\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\12.0\PowerPoint\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\14.0\Word\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\14.0\Excel\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\14.0\PowerPoint\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\15.0\Word\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\15.0\Excel\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\15.0\PowerPoint\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\16.0\Word\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\16.0\Excel\Security', 'PackagerPrompt')
   RegDelete($HKU_MSOffice & '\16.0\PowerPoint\Security', 'PackagerPrompt')

EndFunc